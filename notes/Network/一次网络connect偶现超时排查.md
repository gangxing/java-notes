问题现象 客户端请求接口时不时出现connect超时



先来一个三次握手的时序图

![handshake.png](https://i.loli.net/2019/10/30/2mNDL4kBVvHJ7df.png)

利用tcpdump查看一次接口请求的流程

一、DNS解析

二、建立连接（三次握手）

三、传输请求数据

四、服务端处理

五、传输响应数据

六、断开连接（四次挥手）





> 1.状态流转 ESTABLISHED LISTEN CLOSED TIME_WAIT .......
>
> 2.每种过程中，服务端核心操作是什么
>
> 3.连接超时，是从哪个时刻开始计时的
>
> 4.连接超时，如果网络通顺，服务端可能的问题
>
> 5.构建一个服务端，使连接超时
>
> 6.序列号(ISN)真的是随机生成的吗
>
> 32位无符号整型，所以ISN可表示0-4294967295(2^32-1)
>
> 刚开始是随机生成的，后续每秒钟按照固定步长增加。
>
> 关于端口，客户端 每个连接单独分配一个 这样就可以将接收的数据放到正确的buffer中？
>
> 那服务端呢？也是吗
>
> 关于标志位 服务端向客户端发数据 ACK
>
> 客户端向服务端发数据 PSH ACK 



> 